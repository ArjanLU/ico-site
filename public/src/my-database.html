<link rel="import" href="../bower_components/polymer/polymer-element.html"/>

<script>
class IcoDatabase extends Polymer.Element
{
    static get properties(){
        return { 
            blogarticles:{type:Array, value:[], notify:true},
            trainingen:{type:Array, value:[], notify:true},
            meetupdata:{type:Array, value:[], notify:true}
        }
    }
    static get is(){
        return 'ico-database';
    }

    constructor(){
        super();
        // Initialize Firebase
        firebase.initializeApp({
            apiKey: "AIzaSyDpxkhpOZ1PPresvEfqjuJ5tmjHCkFEaho",
            authDomain: "iconica-site.firebaseapp.com",
            databaseURL: "https://iconica-site.firebaseio.com",
            projectId: "iconica-site",
            storageBucket: "iconica-site.appspot.com",
            messagingSenderId: "319029813406"
        });
    }

    connectedCallback(){
        firebase.database().ref("blogs").on('value',(data) => {
            console.log("setting blogarticles from firebase", data.val());
            this.blogarticles = Object.values(data.val());
        });
        firebase.database().ref("trainingen").on('value',(data) => {
            console.log("setting trainingen from firebase", data.val());
            this.trainingen = Object.values(data.val());
        });
        firebase.database().ref("meetups").on('value',(data) => {
            console.log("setting meetups from firebase", data.val());
            this.meetupdata = Object.values(data.val());
        });
    }

    saveSignup(event, user){
        firebase.database().ref("signups").push({
            event:event.name,
            date:event.date,
            type:(event.type == undefined ? "meetup" : event.type == 'p' ? "pitstop" : "training"),
            email:user
        });
    }
}
customElements.define(IcoDatabase.is, IcoDatabase);
</script>